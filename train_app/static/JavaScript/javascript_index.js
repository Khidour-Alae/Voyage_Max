document.addEventListener('DOMContentLoaded', function() {
    var villes = ['AEROPORT CDG2 TGV ROISSY',
    'AGDE',
    'AGEN',
    'AIME LA PLAGNE',
    'AIX EN PROVENCE TGV',
    'AIX LES BAINS LE REVARD',
    'ALBERTVILLE',
    'ALBI MADELEINE',
    'ALBI VILLE',
    'AMIENS',
    'ANCENIS',
    "ANDORRE - L'HOSPITALET",
    'ANGERS ST LAUD',
    'ANGOULEME',
    'ANNECY',
    'ANNEMASSE',
    'ANTIBES',
    'ARCACHON',
    'ARGELES SUR MER',
    'ARGENTON SUR CREUSE',
    'ARLES',
    'ARRAS',
    'ARVANT',
    'ASSIER',
    'AUBIN',
    'AUGSBURG HBF',
    'AUMONT AUBRAC',
    'AURAY',
    'AURILLAC',
    'AUTERIVE',
    'AVIGNON CENTRE',
    'AVIGNON TGV',
    'AX LES THERMES',
    'BADEN BADEN',
    'BANASSAC LA CANOURGUE',
    'BANYULS SUR MER',
    'BAR LE DUC',
    'BARCELONA SANTS',
    'BASEL SBB',
    'BAYONNE',
    'BEAUNE',
    'BEDARIEUX',
    'BELFORT-MONTBELIARD TGV',
    'BELLEGARDE',
    'BESANCON - F COMTE TGV',
    'BESANCON VIOTTE',
    'BETHUNE',
    'BEZIERS',
    'BIARRITZ',
    'BORDEAUX ST JEAN',
    'BOULOGNE VILLE',
    'BOURG EN BRESSE',
    'BOURG ST MAURICE',
    'BOURGES',
    'BRASSAC LES MINES STE FLORINE',
    'BREST',
    'BRETENOUX BIARS',
    'BRIANCON',
    'BRIVE LA GAILLARDE',
    'BRUXELLES MIDI BRUSSEL ZUID',
    'CAHORS',
    'CALAIS FRETHUN',
    'CALAIS VILLE',
    'CAMPAGNAC ST GENIEZ',
    'CANNES',
    'CAPDENAC',
    'CARCASSONNE',
    'CARMAUX',
    'CAUSSADE TARN ET GARONNE',
    'CEILHES ROQUEREDONDE',
    'CERBERE',
    'CHALON SUR SAONE',
    'CHALONS EN CHAMPAGNE',
    'CHAMBERY CHALLES LES EAUX',
    'CHAMPAGNE-ARDENNE',
    'CHARLEVILLE MEZIERES',
    'CHATEAUROUX',
    'CHATELLERAULT',
    'CHORGES',
    'CLERMONT FERRAND',
    'CLUSES  74',
    'COLLIOURE',
    'COLMAR',
    'CRANSAC',
    'CREST',
    'CROIX WASQUEHAL',
    'DAX',
    'DIE',
    'DIJON VILLE',
    'DOL DE BRETAGNE',
    'DOLE VILLE',
    'DOUAI',
    'DUNKERQUE',
    'ELNE',
    'EMBRUN',
    'EPINAL',
    'ETAPLES LE TOUQUET',
    'EVIAN LES BAINS',
    'FACTURE BIGANOS',
    'FIGEAC',
    'FIGUERES VILA TGV',
    'FOIX',
    'FORBACH',
    'FRANKFURT MAIN HBF',
    'FRASNE',
    'FREIBURG BREISGAU HBF',
    'FUTUROSCOPE',
    'GAP',
    'GENEVE',
    'GIRONA',
    'GOURDON',
    'GRAMAT',
    'GRENOBLE',
    'GUINGAMP',
    'HAZEBROUCK',
    'HENDAYE',
    'HYERES',
    'ISSOIRE',
    'ISSOUDUN',
    'JONZAC',
    'KAISERSLAUTERN HBF',
    'KARLSRUHE HBF',
    "L'ARGENTIERE LES ECRINS   (05)",
    'LA BAULE ESCOUBLAC',
    'LA ROCHE SUR YON',
    'LA ROCHELLE VILLE',
    'LA SOUTERRAINE',
    'LA TESTE',
    'LAHR SCHWARZW',
    'LAMBALLE',
    'LANDERNEAU',
    'LANDRY',
    'LANNEMEZAN',
    'LANNION',
    'LAROQUEBROU',
    'LATOUR DE CAROL ENVEITG',
    'LAUSANNE',
    'LAVAL',
    "LE BOUSQUET D'ORB",
    'LE CREUSOT MONTCEAU MONTCHANIN',
    'LE CROISIC',
    'LE HAVRE',
    'LE MANS',
    'LE MONASTIER',
    'LE POULIGUEN',
    'LENS',
    'LES ARCS DRAGUIGNAN',
    'LES AUBRAIS ORLEANS',
    'LES CABANNES',
    "LES SABLES D'OLONNE",
    'LIBOURNE',
    'LILLE (intramuros)',
    'LIMOGES BENEDICTINS',
    'LORIENT',
    'LORRAINE TGV',
    'LOURDES',
    'LUC EN DIOIS',
    'LUCON',
    'LUNEVILLE',
    'LUXEMBOURG',
    'LUZENAC GARANOU',
    'LYON (intramuros)',
    'LYON-SAINT EXUPERY TGV',
    'MACON LOCHE TGV',
    'MACON VILLE',
    'MAGALAS',
    'MANNHEIM HBF',
    'MANTES LA JOLIE',
    'MARMANDE',
    'MARNE LA VALLEE CHESSY',
    'MARSEILLE BLANCARDE',
    'MARSEILLE ST CHARLES',
    'MARVEJOLS',
    'MASSIAC BLESLE',
    'MASSY PALAISEAU',
    'MASSY TGV',
    'MERENS LES VALS',
    'METZ VILLE',
    'MEUSE TGV',
    'MILANO P GARIBALDI',
    'MILLAU',
    'MIRAMAS',
    'MONTAUBAN VILLE BOURBON',
    'MONTBARD',
    'MONTDAUPHIN GUILLESTRE',
    'MONTELIMAR GARE SNCF',
    'MONTPELLIER SAINT-ROCH',
    'MONTPELLIER SUD DE FRANCE',
    'MONTREJEAU GOURDAN POLIGNAN',
    'MORLAIX',
    'MOUCHARD',
    'MOULINS SUR ALLIER',
    'MOUTIERS SALINS BRIDES L BAINS',
    'MUENCHEN HBF',
    'MULHOUSE VILLE',
    'NANCY',
    'NANTES',
    'NARBONNE',
    'NAUCELLE',
    'NEUSSARGUES',
    'NEVERS',
    'NICE VILLE',
    'NIMES',
    'NIMES PONT DU GARD',
    'NIORT',
    'NURIEUX',
    'OFFENBOURG/OFFENBURG',
    'ORANGE',
    'ORTHEZ',
    'OULX CESANA CLAV SESTRIERE',
    'PAMIERS',
    'PARIS (intramuros)',
    'PAU',
    'PERPIGNAN',
    'PLOUARET TREGOR',
    'POITIERS',
    'PORNICHET',
    'PORT VENDRES VILLE',
    'PORTE PUYMORENS',
    'QUIMPER',
    'QUIMPERLE',
    'RANG DU FLIERS VERTON',
    'REDON',
    'REIMS',
    'REMIREMONT',
    'RENNES',
    'RETHEL',
    'RINGSHEIM/EU-PARK',
    'RIOM CHATEL GUYON',
    'ROANNE',
    'ROCAMADOUR PADIRAC',
    'ROCHEFORT',
    'RODEZ',
    'ROSPORDEN',
    'ROUBAIX',
    'ROUEN RIVE DROITE',
    'SABLE SUR SARTHE',
    'SAINTES',
    'SALLANCHES COMBLOUX MEGEVE',
    'SARREBOURG',
    'SARREBRUCK/SAARBRUECKEN',
    'SAUMUR',
    'SAVERDUN',
    'SAVERNE',
    'SEDAN',
    'SELESTAT',
    'SETE',
    'SEVERAC LE CHATEAU',
    'SOUILLAC',
    'ST AVRE LA CHAMBRE',
    'ST BRIEUC',
    "ST CHELY D'APCHER",
    'ST CHRISTOPHE',
    'ST DENIS PRES MARTEL',
    'ST DIE DES VOSGES',
    'ST ETIENNE CHATEAUCREUX',
    'ST FLOUR CHAUDES AIGUES',
    'ST GAUDENS',
    'ST GEORGES DE LUZENCON',
    'ST GERMAIN DES FOSSES',
    'ST GERVAIS LES BAINS LE FAYET',
    'ST JEAN DE LUZ CIBOURE',
    'ST JEAN DE MAURIENNE ARVAN',
    'ST MAIXENT DEUX SEVRES',
    'ST MALO',
    'ST MICHEL VALLOIRE',
    'ST NAZAIRE',
    'ST PIERRE DES CORPS',
    'ST QUENTIN',
    'ST RAPHAEL VALESCURE',
    'ST ROME DE CERNON',
    'STRASBOURG',
    'STUTTGART HBF',
    'SURGERES',
    'TARASCON SUR ARIEGE',
    'TARBES',
    'TBD',
    'TGV HAUTE PICARDIE',
    'THIONVILLE',
    'THONON LES BAINS',
    'TORINO PORTA SUSA',
    'TOULON',
    'TOULOUSE MATABIAU',
    'TOURCOING',
    'TOURNEMIRE ROQUEFORT',
    'TOURS',
    'ULM HBF',
    'UZERCHE',
    'VALENCE TGV RHONE-ALPES SUD',
    'VALENCE VILLE',
    'VALENCIENNES',
    'VALLORBE',
    'VANNES',
    'VENDOME VILLIERS SUR LOIR',
    'VERSAILLES CHANTIERS',
    'VEYNES DEVOLUY',
    'VICHY',
    'VIERZON VILLE',
    'VITRE',
    'VITRY LE FRANCOIS GARE',
    'VIVIEZ DECAZEVILLE',
    'ZUERICH HB'];
    var inputVilleDepart = document.getElementById('ville_depart');
    var listeVilles = document.getElementById('liste_villes');
    var villeChoisie = false;

    // Fonction pour ajouter une ville à la liste de suggestions
    function ajouterVilleALaListe(ville) {
        var li = document.createElement('li');
        li.textContent = ville;
        li.onclick = function() {
            inputVilleDepart.value = this.textContent;
            villeChoisie = true;
            listeVilles.innerHTML = '';
            listeVilles.style.display = 'none';
            inputVilleDepart.focus();
        };
        listeVilles.appendChild(li);
    }

    // Fonction pour afficher les suggestions
    function afficherSuggestions() {
        var valeurInput = inputVilleDepart.value.toLowerCase();
        listeVilles.innerHTML = '';
        villeChoisie = false;

        // Toujours afficher la liste lorsqu'on clique ou qu'on tape
        var suggestions = villes.filter(function(ville) {
            return ville.toLowerCase().startsWith(valeurInput) || !valeurInput;
        });

        suggestions.forEach(ajouterVilleALaListe);
        listeVilles.style.display = suggestions.length ? 'block' : 'none';
    }

    inputVilleDepart.addEventListener('input', afficherSuggestions);
    inputVilleDepart.addEventListener('click', function(event) {
        afficherSuggestions();
        event.stopPropagation(); // Empêche l'événement de se propager au document
    });

    // Fermer la liste de suggestions lorsqu'on clique en dehors
    document.addEventListener('click', function() {
        listeVilles.innerHTML = '';
        listeVilles.style.display = 'none';
    });

    // Empêcher la soumission du formulaire si aucune ville de la liste n'a été choisie
    document.querySelector('form').addEventListener('submit', function(e) {
        if (!villeChoisie) {
            e.preventDefault();
            alert("Veuillez choisir une ville de la liste.");
        }
    });
});
